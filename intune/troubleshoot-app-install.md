---
title: 排查应用安装问题
titleSuffix: Microsoft Intune
description: Microsoft Intune 疑难解答窗格有助于排查应用安装问题。
keywords: ''
author: Erikre
ms.author: erikre
manager: dougeby
ms.date: 02/19/2019
ms.topic: troubleshooting
ms.prod: ''
ms.service: microsoft-intune
ms.localizationpriority: medium
ms.technology: ''
ms.assetid: b613f364-0150-401f-b9b8-2b09470b34f4
ms.reviewer: mghadial
search.appverid: MET150
ms.custom: intune-azure
ms.collection: M365-identity-device-management
ms.openlocfilehash: 574f509383891ff3e8e0f4c1b04a19832a378829
ms.sourcegitcommit: 484a898d54f5386fdbce300225aaa3495cecd6b0
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/01/2019
ms.locfileid: "58799495"
---
# <a name="troubleshoot-app-installation-issues"></a>排查应用安装问题

在 Microsoft Intune MDM 托管的设备上，有时应用安装可能会失败。 当这些应用安装失败时，可能难以了解失败原因或解决此问题。 Microsoft Intune 提供应用安装失败详细信息，以便支持人员和 Intune 管理员能够查看应用信息，从而根据请求为用户提供帮助。 Intune 疑难解答窗格提供失败详细信息，包括用户设备上托管应用的详细信息。 在“托管应用”窗格中，可以在各个设备下详细了解应用的端到端生命周期。 可查看安装问题，如应用的创建时间、修改时间、定目标时间以及传递给设备的时间。 

## <a name="app-troubleshooting-details"></a>应用疑难解答详细信息

Intune 根据特定用户设备上安装的应用，提供应用疑难解答详细信息。

1. 登录到 [Azure 门户](https://portal.azure.com)。
2. 选择“所有服务” > “Intune”。 Intune 位于“监视 + 管理”部分中。
3. 在“Intune”窗格中，选择“疑难解答”。
4. 单击“选择用户”，选择要对其排查问题的用户。 此时，“选择用户”窗格显示。
5. 通过键入名称或电子邮件地址选择用户。 单击窗格底部的“选择”。 此用户的疑难解答信息显示在“疑难解答”窗格中。 
6. 在“设备”列表中，选择要对其排查问题的设备。
    ![Intune 疑难解答窗格。](media/troubleshoot-app-install-01.png)
7. 在选定设备窗格中，选择“托管应用”。 此时，托管应用列表显示。
    ![Intune 托管的特定设备的详细信息。](media/troubleshoot-app-install-02.png)
8. 在列表中，选择“安装状态”为“失败”的应用。
    ![显示安装失败详细信息的选定应用。](media/troubleshoot-app-install-03.png)

    > [!Note]  
    > 可以将同一应用分配到多个组，但应用的预期操作（意向）应不同。 例如，如果在应用分配期间对用户排除了应用，那么应用的解析意向显示为“已排除”。 有关详细信息，请参阅[如何解决不同应用意向之间的冲突](apps-deploy.md#how-conflicts-between-app-intents-are-resolved)。<br><br>
    > 如果所需应用安装失败，用户或用户的支持人员可以同步设备并重试应用安装。

应用安装错误详细信息指出问题所在。 根据这些详细信息，可以确定解决问题的最佳措施。 若要详细了解如何排查应用安装问题，请参阅[用于排查应用安装问题的错误代码](https://blogs.technet.microsoft.com/intunesupport/2018/05/15/error-codes-for-troubleshooting-app-installation-issues)。

> [!Note]  
> 还可通过浏览器前往 [https://aka.ms/intunetroubleshooting](https://aka.ms/intunetroubleshooting) 来访问“疑难解答”窗格。

## <a name="win32-app-installation-troubleshooting"></a>Win32 应用安装疑难解答

选择使用 Intune 管理扩展部署的 Win32 应用。 Win32 应用安装失败时，可选择“收集日志”选项。 

> [!IMPORTANT]
> 如果 Win32 应用已在设备上成功安装，则不会启用“收集日志”选项。<p>Intune 管理扩展必须先安装在 Windows客户端上，才能收集 Win32 应用日志信息。 将 PowerShell 脚本或 Win32 应用部署到用户或设备安全组后，将安装 Intune 管理扩展。 有关详细信息，请参阅 [Intune 管理扩展 - 先决条件](intune-management-extension.md#prerequisites)。

### <a name="collect-log-file"></a>收集日志文件

若要收集 Win32 应用安装日志，请先按照[应用疑难解答详细信息](troubleshoot-app-install.md#app-troubleshooting-details)部分中提供的步骤进行操作。 然后，继续执行以下步骤：

1. 单击“安装详细信息”边栏选项卡上的“收集日志”选项。

    <image alt="Win32 app installation details - Collect log option" src="media/troubleshoot-app-install-04.png" width="500" />

2. 使用包含日志文件名的文件路径以开始日志文件收集过程，然后单击“确定”。
    
    > [!NOTE]
    > 日志收集需要最多两小时。 支持的文件类型：.log、.txt、.dmp、.cab、.zip、.xml、.evtx 和 .evtl。 最多允许 25 个文件路径。

3. 收集日志文件后，可选择“日志”链接来下载日志文件。

    <image alt="Win32 app log details - Download logs" src="media/troubleshoot-app-install-05.png" width="500" />

    > [!NOTE]
    > 将显示通知，指示应用日志收集成功。

#### <a name="win32-log-collection-requirements"></a>Win32 日志收集要求

收集日志文件时必须遵循特定要求：

- 必须指定完整的日志文件路径。 
- 可为日志收集指定环境变量，例如：<br>
  %PROGRAMFILES%, %PROGRAMDATA% %PUBLIC%, %WINDIR%, %TEMP%, %TMP%
- 只允许使用精确的文件扩展名，例如：<br>
  .log、.txt、.dmp、.cab、.zip、.xml
- 上传的最大日志文件为 60 MB 或 25 个文件，以先达到者为准。 
- 为满足需要的、可用和卸载应用分配意图的应用启用 Win32 应用安装日志收集。
- 存储的日志已加密，以保护日志中包含的任何 PII 信息。
- 如果开立 Win32 应用支持票证失败，请使用上面提供的步骤附加相关的失败日志。

## <a name="app-installation-errors"></a>应用安装错误

以下错误消息和描述详细介绍了 Android 和 iOS 的安装错误。 

### <a name="android-errors"></a>Android 错误

|    错误消息/代码    |    描述    |
|----------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    应用安装失败。 (0xC7D14FB5)    |    如果 Intune 无法确定导致 Android 应用安装错误的根本原因，则会显示此错误消息。 失败期间 Android 未提供任何信息。       APK 下载成功但应用安装失败时将返回此错误。 通常情况下，出现该错误是因为 APK 文件不正确，无法在设备上安装。 也可能是因为 Google Play 保护出于安全性考虑而阻止安装应用。 此错误的另一个可能原因是设备不支持该应用。 例如，应用要求 API 版本 21 或更高版本，而设备当前使用 API 版本 19。         Intune 将针对 DA 和 KNOX 设备返回此错误。尽管可能出现可供用户单击以进行重试的通知，但如果是 APK 的问题，则绝不会继续失败。 如果该应用是可选应用，则可以忽略该通知。 但是，如果是必需应用，则不能忽略。        |
|    安装文件 (APK) 在下载之后未经安装即被删除，因此取消了应用安装。 (0xC7D14FBA)    |    APK 下载成功，但在用户安装应用前，已从设备中删除该文件。 如果下载和安装之间间隔较长，则可能出现此情况。 例如，用户取消了原始安装，等待一段时间后，单击通知再次重试。         此错误消息仅在 DA 方案中返回。 KNOX 方案中可能以无提示方式执行。 我们会提供用于重试的通知，如此用户可以接受重试，而不是取消安装。 如果该应用是可选应用，则可以忽略该通知。 但是，如果是必需应用，则不能忽略。    |
|    安装期间重启了进程，因此取消了应用安装。 (0xC7D14FBB)    |    在 APK 安装过程中重新启动了设备，导致安装取消。        DA 和 KNOX 设备均会返回此错误消息。 Intune 将提供可供用户单击以进行重试的通知。 如果该应用是可选应用，则可以忽略该通知。 但是，如果是必需应用，则不能忽略。    |
|    成功完成安装后未检测到该应用程序。 (0x87D1041C)    |    用户已显式卸载该应用。 客户端不会返回此错误。 如果在某一时间安装了应用，但用户随后将其卸载，则会生成此错误。 只有必需应用程序会出现此错误。 用户可以卸载非必需的应用。 此错误仅发生在 DA 中。 KNOX 禁止卸载托管应用。       下次同步时将在设备上重新发布通知，提示用户进行安装。   用户可以忽略该通知。 在用户安装该应用之前，将持续报告此错误。    |
|    发生未知错误，导致下载失败。 (0xC7D14FB2)    |    此错误在下载失败时出现。 出现此错误通常是由 Wi-fi 问题或连接速度较慢所致。       此错误仅在 DA 方案中返回。 对于 KNOX 方案，用户不会收到安装提示，此操作以无提示方式执行。 Intune 将提供可供用户单击以进行重试的通知。 如果该应用是可选应用，则可以忽略该通知。 但是，如果是必需应用，则不能忽略。    |
|    发生未知错误，导致下载失败。 下次同步设备时将重试该策略。 (0xC7D15078)    |    此错误在下载失败时出现。 出现此错误通常是由 Wi-fi 问题或连接速度较慢所致。       此错误仅在 DA 方案中返回。 对于 KNOX 方案，用户不会收到安装提示，此操作以无提示方式执行。    |
|    最终用户取消了应用安装。 (0xC7D14FB1)    |    用户已显式卸载该应用。 如果用户取消了 Android OS 安装活动，则会返回此错误。 出现 OS 安装提示时，用户点击了“取消”按钮，或单击关闭了提示。        此错误仅在 DA 方案中返回。 对于 KNOX 方案，用户不会收到安装提示，此操作以无提示方式执行。 Intune 将提供可供用户单击以进行重试的通知。 如果该应用是可选应用，则可以忽略该通知。 但是，如果是必需应用，则不能忽略。    |
|    文件下载进程意外停止。 (0xC7D15015)    |    OS 已在下载进程完成前将其停止。 如果设备电量过低或下载耗时过长，则会出现此错误。       此错误仅在 DA 方案中返回。 对于 KNOX 方案，用户不会收到安装提示，此操作以无提示方式执行。 Intune 将提供可供用户单击以进行重试的通知。 如果该应用是可选应用，则可以忽略该通知。 但是，如果是必需应用，则不能忽略。    |
|    文件下载服务意外停止。 下次同步设备时将重试该策略。 (0xC7D1507C)    |    OS 已在下载进程完成前将其停止。 如果设备电量过低或下载耗时过长，则会出现此错误。       此错误仅在 DA 方案中返回。 对于 KNOX 方案，用户不会收到安装提示，此操作以无提示方式执行。    |

### <a name="ios-errors"></a>iOS 错误

| 错误消息/代码 | 说明/故障排除提示 |
|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| (0x87D12906) | Apple MDM 代理返回安装命令失败的消息。 |
| (0x87D1313C) | 将更新后的下载服务 URL 发送到设备时，网络连接断开。 具体来说，找不到具有指定主机名的服务器。 |
| iOS 设备当前繁忙。 (0x87D11388) | iOS 设备繁忙，因此导致出现错误。 |
| 应用安装失败。 (0x87D13B64) | 应用安装失败。 需要使用 XCODE 日志来解决此错误。 |
| 应用已托管，但已过期或被用户删除。 (0x87D13B66) | 用户已显式卸载该应用。 或者，应用已过期但无法下载，或应用检测与设备响应不匹配。   此外，此错误还可能由 iOS 9.2.2 平台 bug 导致。 |
| 计划安装该应用，但需要兑换代码才能完成该事务。 (0x87D13B60) | 此错误通常发生于 iOS Store 的付费应用。 |
| 成功完成安装后未检测到该应用程序。   (0x87D1041C) | 应用检测进程与设备响应不匹配。 |
| 用户拒绝了安装应用的提议。 (0x87D13B62) | 初始应用安装过程中，用户单击了“取消”。 |
| 用户拒绝了更新应用的提议。 (0x87D13B63) | 最终用户在更新过程中单击了“取消”。 |
| 未知错误 (0x87D103E8) | 出现未知应用安装错误。 如果未出现其他错误，则会显示此错误。 |
| 只能在 Shared iPad 上安装 VPP 应用 (-2016330861)。 | 必须使用 Apple Volume Purchase Program 获取应用，才能在 Shared iPad 上进行安装。 |
| 禁用 App Store 时无法安装应用 (-2016330860)。  | 必须启用 App Store，用户才能安装该应用。 |
| 找不到应用的 VPP 许可证 (-2016330859)。  | 尝试撤消并重新分配应用许可证。 |
| 无法使用 MDM 提供程序安装系统应用 (-2016330858)。 | 不支持安装 iOS 操作系统预安装的应用。 |
| 设备处于丢失模式时无法安装应用 (-2016330857)。 | 在丢失模式下，将阻止对该设备的所有使用。   禁用丢失模式以安装应用。 |
| 设备处于展台模式时无法安装应用 (-2016330856)。 | 尝试将此设备添加到展台模式配置策略的排除组以安装应用。 |
| 无法在此设备上安装 32 位应用 (-2016330852)。 | 该设备不支持安装 32 位应用。 尝试部署 64 位版本的应用。 |
| 用户必须登录 App Store (-2016330855)。 | 用户需要先登录 App Store，然后才能安装应用。 |
| 未知问题。 请稍后重试 (-2016330854)。 | 由于未知原因，应用安装失败。   请稍后重试。 |
| 应用安装失败。 Intune 将在下次设备同步时再次尝试 (-2016330853)。 | 应用安装出现设备错误。 同步设备以尝试再次安装应用。 |

### <a name="other-installation-errors"></a>其他安装错误

|    错误消息/代码    |    描述    |
|-----------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    0x80073CFF、0x80CF201C（客户端错误）    |    若要安装此应用，你必须具有支持旁加载的系统。 确保使用受信任的签名对应用包进行了签名，并且确保在已启用 AllowAllTrustedApps 策略且已加入域的设备上安装了该应用包，或者在具有 Windows 旁加载许可证且已启用 AllowAllTrustedApps 策略的设备上安装了该应用包。 有关更多信息，请参阅[对 Windows 应用商店应用的打包、部署和查询进行故障排除](https://docs.microsoft.com/windows/desktop/appxpkg/troubleshooting)。     |
|    0x80073CF0    |    无法打开包。 可能的原因：<ul><li> 未对包进行签名。</li><li> 发布者名称与签名证书使用者不匹配。</li></ul> 有关信息，请查看 AppxPackagingOM 事件日志。 有关更多信息，请参阅[对 Windows 应用商店应用的打包、部署和查询进行故障排除](https://docs.microsoft.com/windows/desktop/appxpkg/troubleshooting)。    |
|    0x80073CF3    |    包未通过更新、依赖关系或冲突验证。 可能的原因：<ul><li> 传入包与已安装的包冲突。</li><li> 找不到指定的包依赖关系。</li><li> 包不支持正确的处理器体系结构。</li></ul> 有关信息，请查看 AppXDeployment-Server 事件日志。 有关更多信息，请参阅[对 Windows 应用商店应用的打包、部署和查询进行故障排除](https://docs.microsoft.com/windows/desktop/appxpkg/troubleshooting)。    |
|    0x80073CFB    |    已经安装了提供的包，阻止重新安装此包。 如果正在安装的包与已安装的包并不完全相同，则可能会收到此错误。 确认数字签名也是包的一部分。 对包进行重新构建或者重新签名时，该包与以前安装的包在位方面不再完全相同。 用于修复此错误的两个可能的选项如下所示：<ul><li> 递增应用的版本号，然后对包进行重新构建并重新签名。</li><li> 在安装新包之前，请删除系统上每个用户的旧包。</li></ul> 有关更多信息，请参阅[对 Windows 应用商店应用的打包、部署和查询进行故障排除](https://docs.microsoft.com/windows/desktop/appxpkg/troubleshooting)。    |
|    0x87D1041C    |    应用程序安装成功，但未检测到应用程序。 应用已通过 Intune 成功部署，随后可卸载。 卸载应用的原因包括：<ul><li> 最终用户已卸载此应用。</li><li> 包中的标识信息与设备报告不良应用的信息不匹配。</li><li>对于自更新的 MSI，产品版本在 Intune 之外更新后与应用的信息不匹配。</li></ul> 指示用户从公司门户重新安装应用。 注意，在设备下次签入时，将自动重新安装所需应用。    |

## <a name="troubleshooting-apps-from-the-microsoft-store"></a>对 Microsoft 应用商店中的应用进行故障排除

[排除 Microsoft 应用商店应用的打包、部署和查询故障](https://msdn.microsoft.com/library/windows/desktop/hh973484.aspx)主题中的信息有助于解决使用 Intune 或其他方式从 Microsoft 应用商店安装应用时可能会遇到的问题。

## <a name="next-steps"></a>后续步骤

- 有关其他 Intune 疑难解答信息，请参阅[使用疑难解答门户为公司用户提供帮助](help-desk-operators.md)。 
- 了解 Microsoft Intune 中的任何已知问题。 有关详细信息，请参阅 [Microsoft Intune 中的已知问题](known-issues.md)。
- 需要更多帮助？ 请参阅[如何获取对 Microsoft Intune 的支持](get-support.md)。
